# راهنمای نصب و تست پنل پیکربندی تابش

## نصب افزونه در وردپرس

### پیش‌نیازها
- WordPress 6.0 یا بالاتر
- PHP 8.0 یا بالاتر
- MySQL 5.7 یا بالاتر

### مراحل نصب

#### روش 1: نصب از طریق کد منبع (توسعه‌دهندگان)

1. **کپی فایل‌های پلاگین**
   ```bash
   cd /path/to/wordpress/wp-content/plugins/
   git clone https://github.com/tabshhh4-sketch/Tabesh_v2.git tabesh-v2
   cd tabesh-v2
   ```

2. **نصب وابستگی‌های JavaScript**
   ```bash
   npm install
   ```

3. **ساخت فایل‌های React**
   ```bash
   npm run build
   ```

4. **فعال‌سازی افزونه**
   - به پنل مدیریت WordPress بروید
   - به منوی Plugins > Installed Plugins بروید
   - افزونه "Tabesh v2 - Print Shop Order Management" را فعال کنید

#### روش 2: نصب از طریق ZIP

1. **ایجاد فایل ZIP**
   ```bash
   cd /path/to/Tabesh_v2
   npm install
   npm run build
   zip -r tabesh-v2.zip . -x "node_modules/*" ".git/*" ".gitignore" "*.md"
   ```

2. **آپلود در WordPress**
   - به Plugins > Add New بروید
   - روی "Upload Plugin" کلیک کنید
   - فایل ZIP را انتخاب و آپلود کنید
   - افزونه را فعال کنید

## دسترسی به پنل پیکربندی

بعد از فعال‌سازی افزونه:

1. در منوی کناری WordPress منوی **"Tabesh v2"** را خواهید دید
2. زیرمنوی **"Settings"** (تنظیمات) را کلیک کنید
3. پنل پیکربندی جامع با 8 تب باز خواهد شد:
   - تنظیمات هوش مصنوعی
   - پارامترهای محصولات
   - قیمت‌گذاری
   - تنظیمات پیامک
   - تنظیمات فایروال
   - تنظیمات فایل
   - سطح دسترسی
   - برون‌ریزی و درون‌ریزی

## ویژگی‌های هر تب

### 1. تنظیمات هوش مصنوعی
**اتصال به ChatGPT:**
- API Key: کلید API از OpenAI
- مدل ChatGPT: انتخاب نسخه مدل (gpt-4, gpt-3.5-turbo)
- Organization ID: شناسه سازمان (اختیاری)
- فعال‌سازی: روشن/خاموش کردن سرویس AI

**تنظیمات پیشرفته:**
- دمای مدل (Temperature): کنترل خلاقیت پاسخ‌ها (0-2)
- حداکثر توکن‌ها: محدودیت طول پاسخ
- System Prompt: دستورالعمل اولیه برای AI
- ذخیره پاسخ‌های تکراری
- ثبت لاگ درخواست‌ها

### 2. پارامترهای محصولات
**انتخاب محصول:**
19 نوع محصول مختلف شامل:
- چاپ کتاب
- چاپ قبض (طرح آماده و دلخواه)
- چاپ جعبه (طرح آماده و دلخواه)
- چاپ فاکتور (طرح آماده و دلخواه)
- چاپ کارت ویزیت (طرح آماده و دلخواه)
- چاپ پوستر (طرح آماده و دلخواه)
- چاپ تراکت (طرح آماده و دلخواه)
- چاپ طلاکوب/نقره‌کوب/مس‌کوب
- چاپ مقالات با صحافی
- چاپ تحقیق/جزوه (با انجام تحقیق یا ارسال فایل)
- چاپ وقف‌نامه و یادبود
- چاپ تبلیغات

**پارامترهای هر محصول:**
- فعال/غیرفعال کردن محصول
- حداقل و حداکثر تعداد سفارش
- زمان تحویل (روز)
- قیمت پایه
- توضیحات اضافی
- پارامترهای سفارشی (JSON)

### 3. قیمت‌گذاری
**تنظیمات عمومی:**
- واحد پول و نماد
- موقعیت نمایش نماد (قبل/بعد از عدد)
- تعداد ارقام اعشار

**مالیات و تخفیف:**
- فعال‌سازی محاسبه مالیات
- نرخ مالیات (درصد)
- حداکثر تخفیف قابل اعمال
- فعال‌سازی تخفیف

**تخفیف حجمی:**
- فعال‌سازی تخفیف حجمی
- جدول تخفیف (JSON format)

**هزینه‌های اضافی:**
- هزینه ارسال پایه
- ارسال رایگان
- حداقل مبلغ برای ارسال رایگان

### 4. تنظیمات پیامک
**پیکربندی سرویس:**
- انتخاب ارائه‌دهنده (کاوه‌نگار، فراز اس‌ام‌اس، و...)
- API Key
- شماره ارسال‌کننده
- URL وب‌سرویس (برای سرویس سفارشی)

**قالب پیام‌های خودکار:**
- پیامک ثبت سفارش
- پیامک تغییر وضعیت
- پیامک آماده ارسال
- متغیرهای قابل استفاده در قالب‌ها

**تنظیمات پیشرفته:**
- ثبت لاگ پیامک‌ها
- حداکثر تلاش مجدد در صورت خطا

### 5. تنظیمات فایروال
- فعال‌سازی فایروال
- محدودیت تعداد درخواست (Rate Limiting)
- حداکثر درخواست در دقیقه
- مسدودسازی IP
- لیست IP های مسدود شده
- حفاظت در برابر Brute Force

### 6. تنظیمات فایل
- حداکثر حجم فایل (MB)
- فرمت‌های مجاز
- اسکن فایل‌های آپلود شده
- مسیر ذخیره‌سازی
- حذف خودکار فایل‌های قدیمی
- مدت نگهداری فایل‌ها (روز)

### 7. سطح دسترسی
**دسترسی‌های کاربران:**
- مشتریان: مشاهده و لغو سفارشات
- مدیران: حذف سفارشات
- کارمندان: ویرایش سفارشات
- نیاز به تایید برای سفارشات
- نقش‌های مجاز برای تایید

### 8. برون‌ریزی و درون‌ریزی
**تنظیمات Export/Import:**
- امکان برون‌ریزی و درون‌ریزی داده‌ها
- فرمت برون‌ریزی (CSV, JSON, XML, Excel)
- شامل اطلاعات مشتریان و سفارشات

**پشتیبان‌گیری خودکار:**
- فعال‌سازی backup خودکار
- دوره پشتیبان‌گیری (روز)
- تعداد نسخه‌های پشتیبان نگهداری شده

## تست عملکرد

### 1. بررسی رابط کاربری
- ✓ تمام تب‌ها به درستی نمایش داده می‌شوند
- ✓ انتقال بین تب‌ها روان است
- ✓ متون فارسی به درستی نمایش داده می‌شوند
- ✓ طراحی responsive است

### 2. تست ذخیره‌سازی
1. در هر تب تغییراتی ایجاد کنید
2. دکمه "ذخیره تنظیمات" را کلیک کنید
3. پیام موفقیت باید نمایش داده شود
4. صفحه را رفرش کنید
5. تنظیمات باید حفظ شده باشند

### 3. تست API
با استفاده از Developer Tools مرورگر:
- درخواست GET به `/wp-json/tabesh/v2/settings` باید تنظیمات را برگرداند
- درخواست POST با داده‌های جدید باید تنظیمات را ذخیره کند

### 4. تست امنیتی
- سطح دسترسی: فقط کاربران با نقش `manage_options` می‌توانند تنظیمات را ببینند
- تمام ورودی‌ها sanitize می‌شوند
- داده‌های حساس (API Keys) به صورت password نمایش داده می‌شوند

## مشکلات احتمالی و راه‌حل

### افزونه فعال نمی‌شود
- نسخه PHP و WordPress را بررسی کنید
- لاگ‌های خطای WordPress را چک کنید

### تنظیمات ذخیره نمی‌شوند
- دسترسی‌های نوشتن در دیتابیس را بررسی کنید
- Developer Console مرورگر را برای خطاهای JavaScript چک کنید

### ظاهر نامناسب
- Cache مرورگر را پاک کنید
- مطمئن شوید فایل CSS به درستی بارگذاری شده است

### مشکلات Build
- حذف و نصب مجدد node_modules:
  ```bash
  rm -rf node_modules
  npm install
  npm run build
  ```

## توسعه بیشتر

### افزودن تب جدید
1. در `assets/js/src/components/` یک کامپوننت جدید بسازید
2. کامپوننت را در `SettingsPanel.js` import و به آرایه `tabs` اضافه کنید
3. در `includes/api/class-rest-api.php` متد `sanitize_settings` را بروزرسانی کنید
4. Build و test کنید

### افزودن محصول جدید
در `ProductParametersTab.js` محصول جدید را به آرایه `productTypes` اضافه کنید

## پشتیبانی
برای مشکلات یا سوالات:
- GitHub Issues: https://github.com/tabshhh4-sketch/Tabesh_v2/issues
- Documentation: مستندات کامل در پوشه پروژه

---
**نسخه:** 1.0.0  
**تاریخ:** 2025-12-31  
**توسعه‌دهنده:** Tabesh Team
