# راهنمای نصب و راه‌اندازی Tabesh v2

## نصب افزونه

> **توجه مهم:** این افزونه شامل فایل‌های JavaScript که از قبل build شده‌اند می‌باشد و نیازی به اجرای npm build برای استفاده عادی نیست. تنها در صورتی که می‌خواهید کد React را تغییر دهید، نیاز به نصب npm dependencies و build خواهید داشت.

### نصب از طریق مدیریت وردپرس

1. به بخش افزونه‌ها > افزودن در پنل مدیریت وردپرس بروید
2. روی دکمه "بارگذاری افزونه" کلیک کنید
3. فایل zip افزونه را انتخاب کنید
4. روی "هم‌اکنون نصب کنید" کلیک کنید
5. پس از نصب، افزونه را فعال کنید

### نصب دستی

1. فایل افزونه را از حالت فشرده خارج کنید
2. پوشه `tabesh-v2` را به مسیر `/wp-content/plugins/` آپلود کنید
3. از طریق منوی "افزونه‌ها" در وردپرس، افزونه را فعال کنید

## پیکربندی اولیه

### تنظیمات پایه

1. بعد از فعال‌سازی، به منوی "Tabesh v2" در پنل مدیریت بروید
2. وارد بخش "تنظیمات" شوید
3. تنظیمات زیر را انجام دهید:
   - واحد پول: IRR (ریال ایران)
   - فرمت تاریخ: Y-m-d
   - فرمت زمان: H:i:s
   - تعداد سفارشات در هر صفحه: 20

### ایجاد پنل‌های کاربری

افزونه به صورت خودکار نقش‌های کاربری زیر را ایجاد می‌کند:

1. **مشتری تابش** (tabesh_customer)
   - مشاهده سفارشات شخصی
   - ثبت سفارش جدید

2. **مدیر تابش** (tabesh_manager)
   - مشاهده تمام سفارشات
   - ویرایش و حذف سفارشات
   - تخصیص سفارشات
   - مدیریت مشتریان
   - مشاهده گزارشات

3. **کارمند تابش** (tabesh_employee)
   - مشاهده سفارشات اختصاص داده شده
   - به‌روزرسانی وضعیت سفارشات

## جداول پایگاه داده

افزونه جداول زیر را در پایگاه داده ایجاد می‌کند:

- `wp_tabesh_orders`: سفارشات
- `wp_tabesh_order_meta`: متای سفارشات
- `wp_tabesh_order_items`: آیتم‌های سفارش
- `wp_tabesh_customers`: مشتریان

این جداول به صورت خودکار هنگام فعال‌سازی افزونه ایجاد می‌شوند.

## راه‌اندازی محیط توسعه

### نصب وابستگی‌ها

```bash
# نصب npm packages
npm install
```

### ساخت فایل‌های React

```bash
# ساخت نسخه production
npm run build

# حالت توسعه با hot reload
npm run start
```

## مسیرها و نقاط پایانی API

### سفارشات
- `GET /wp-json/tabesh/v2/orders` - لیست سفارشات
- `POST /wp-json/tabesh/v2/orders` - ایجاد سفارش
- `GET /wp-json/tabesh/v2/orders/{id}` - جزئیات سفارش
- `PUT /wp-json/tabesh/v2/orders/{id}` - ویرایش سفارش
- `DELETE /wp-json/tabesh/v2/orders/{id}` - حذف سفارش

### مشتریان
- `GET /wp-json/tabesh/v2/customers` - لیست مشتریان
- `POST /wp-json/tabesh/v2/customers` - ایجاد مشتری

### تنظیمات
- `GET /wp-json/tabesh/v2/settings` - دریافت تنظیمات
- `POST /wp-json/tabesh/v2/settings` - به‌روزرسانی تنظیمات

## نکات امنیتی

1. همیشه از آخرین نسخه افزونه استفاده کنید
2. رمزهای عبور قوی برای کاربران ایجاد کنید
3. دسترسی‌های کاربران را محدود کنید
4. از SSL برای امنیت بیشتر استفاده کنید
5. به صورت منظم از پایگاه داده پشتیبان تهیه کنید

## رفع مشکلات رایج

### افزونه فعال نمی‌شود

- نسخه PHP را بررسی کنید (حداقل 8.0)
- نسخه وردپرس را بررسی کنید (حداقل 6.0)
- خطاهای PHP را در log بررسی کنید

### رابط کاربری نمایش داده نمی‌شود

**راه‌حل:**
- اگر از مخزن GitHub نصب کرده‌اید، فایل‌های build باید از قبل موجود باشند
- در صورتی که رابط کاربری نمایش داده نمی‌شود:
  1. مطمئن شوید فایل‌های `assets/js/build/index.js` و `assets/js/build/index.asset.php` وجود دارند
  2. در صورت عدم وجود، npm dependencies را نصب و build را اجرا کنید:
     ```bash
     npm install
     npm run build
     ```
- Cache مرورگر را پاک کنید
- Console مرورگر را برای خطاهای JavaScript بررسی کنید

### مشکلات API

- Permalinks را دوباره ذخیره کنید
- نقش کاربری و دسترسی‌ها را بررسی کنید
- Network tab در developer tools را بررسی کنید

## پشتیبانی

برای دریافت پشتیبانی:
1. مستندات را مطالعه کنید
2. Issues موجود در GitHub را جستجو کنید
3. یک Issue جدید در GitHub ایجاد کنید

## منابع مفید

- [مستندات وردپرس](https://codex.wordpress.org/)
- [راهنمای React](https://react.dev/)
- [WordPress REST API](https://developer.wordpress.org/rest-api/)
